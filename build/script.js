!function(){"use strict";var e=window.wp.element;const{createHigherOrderComponent:t}=wp.compose,{Fragment:o,useEffect:n,useState:a,useRef:c}=wp.element,{InspectorControls:s}=wp.blockEditor,{PanelBody:r,ToggleControl:l,PanelRow:i,TextControl:d,SelectControl:u}=wp.components,{isURL:p}=wp.url;wp.hooks.addFilter("blocks.registerBlockType","ubc/extension/text-from-cf/button/add-attributes",(function(e,t){return"core/button"!==t?e:{...e,attributes:{...e.attributes,CFToText_enable:{type:"boolean",default:!1},CFToText_key:{type:"string",default:""}},usesContext:["postId"]}}));const m=t((t=>c=>{const{name:i,attributes:d,setAttributes:p,context:m}=c,{CFToText_enable:b,CFToText_key:_}=d,{postId:x}=m,[f,w]=a([]);if("core/button"!==i)return(0,e.createElement)(t,{...c});n((()=>{(async()=>{const e=new FormData;e.append("action","wp_text_from_cf_get_meta_keys"),e.append("nonce",wp_text_from_cf.nonce);const t=await fetch(ajaxurl,{method:"POST",credentials:"same-origin",body:e}),o=await t.json();o.success&&w(o.data)})()}),[]),n((()=>{T()}),[_]),n((()=>{!1!==b?T():p({text:""})}),[b]);const T=async()=>{const e=new FormData;e.append("action","text_to_cf_get_custom_field_value"),e.append("meta_key",_),e.append("post_id",x),e.append("nonce",wp_text_from_cf.nonce);const t=await fetch(ajaxurl,{method:"POST",credentials:"same-origin",body:e}),o=await t.json();!1===o.success&&p({text:o.data}),p({text:o.data}),jQuery(".cf-editor-button-disabled").each(((e,t)=>{t.parentElement.setAttribute("cf-disabled","disabled")}))};return(0,e.createElement)(o,null,(0,e.createElement)(t,{...c}),(0,e.createElement)(s,null,(0,e.createElement)(r,{title:"Text Settings",initialOpen:!0},(0,e.createElement)(l,{label:"Enable text to custom field",checked:b,onChange:()=>{p({CFToText_enable:!b})}}),b?(0,e.createElement)(u,{label:"Text to Custom Field",value:_,options:f.map((e=>({label:e,value:e}))),onChange:e=>{p({CFToText_key:e})},__nextHasNoMarginBottom:!0}):"")))}),"withInspectorControl");wp.hooks.addFilter("editor.BlockEdit","ubc/extension/text-from-cf/button/add-controls",m)}();